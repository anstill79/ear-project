<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>SAL - (masking dilemma)</title>
    <script src="/Audiogram/lib/chartjs447.umd.js"></script>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <div class="container">
      <header>
        <div>
          <h1>SAL Calculator (masking dilemma)</h1>
        </div>
        <div class="tiny-flex">
          <button popovertarget="help_text_modal" id="helpButton">Help</button>
          <button popovertarget="custom_norms_modal" id="normsButton">
            Custom Norms
          </button>
        </div>
      </header>

      <div class="main-layout">
        <div class="card" style="border-left: 4px solid var(--right-ear)">
          <h3
            style="color: var(--right-ear); padding-left: 10px; margin-top: 0px"
          >
            Right Ear
          </h3>
          <table>
            <thead>
              <tr>
                <th>Freq</th>
                <th>500Hz</th>
                <th>1kHz</th>
                <th>2kHz</th>
                <th>4kHz</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="row-label">Initial AC</td>
                <td>
                  <input
                    type="number"
                    id="acr500Hz"
                    step="5"
                    oninput="updateChart(event)"
                    onblur="syncValues('r', '500Hz')"
                  />
                </td>
                <td>
                  <input
                    type="number"
                    id="acr1kHz"
                    step="5"
                    oninput="updateChart(event)"
                    onblur="syncValues('r', '1kHz')"
                  />
                </td>
                <td>
                  <input
                    type="number"
                    id="acr2kHz"
                    step="5"
                    oninput="updateChart(event)"
                    onblur="syncValues('r', '2kHz')"
                  />
                </td>
                <td>
                  <input
                    type="number"
                    id="acr4kHz"
                    step="5"
                    oninput="updateChart(event)"
                    onblur="syncValues('r', '4kHz')"
                  />
                </td>
              </tr>
              <tr>
                <td class="row-label">Masked AC</td>
                <td>
                  <input
                    type="number"
                    id="macr500Hz"
                    step="5"
                    oninput="updateChart(event)"
                  />
                </td>
                <td>
                  <input
                    type="number"
                    id="macr1kHz"
                    step="5"
                    oninput="updateChart(event)"
                  />
                </td>
                <td>
                  <input
                    type="number"
                    id="macr2kHz"
                    step="5"
                    oninput="updateChart(event)"
                  />
                </td>
                <td>
                  <input
                    type="number"
                    id="macr4kHz"
                    step="5"
                    oninput="updateChart(event)"
                  />
                </td>
              </tr>
              <tr>
                <td class="row-label">Norm Shift</td>
                <td>
                  <input
                    type="number"
                    id="nr500Hz"
                    value="50"
                    step="5"
                    oninput="updateChart(event)"
                  />
                </td>
                <td>
                  <input
                    type="number"
                    id="nr1kHz"
                    value="60"
                    step="5"
                    oninput="updateChart(event)"
                  />
                </td>
                <td>
                  <input
                    type="number"
                    id="nr2kHz"
                    value="60"
                    step="5"
                    oninput="updateChart(event)"
                  />
                </td>
                <td>
                  <input
                    type="number"
                    id="nr4kHz"
                    value="60"
                    step="5"
                    oninput="updateChart(event)"
                  />
                </td>
              </tr>
              <tr class="result-row">
                <td class="row-label">Est. SAL BC</td>
                <td id="resr500Hz">-</td>
                <td id="resr1kHz">-</td>
                <td id="resr2kHz">-</td>
                <td id="resr4kHz">-</td>
              </tr>
            </tbody>
          </table>
        </div>

        <div class="card" style="border-left: 4px solid var(--left-ear)">
          <h3
            style="color: var(--left-ear); padding-left: 10px; margin-top: 0px"
          >
            Left Ear
          </h3>
          <table>
            <thead>
              <tr>
                <th>Freq</th>
                <th>500Hz</th>
                <th>1kHz</th>
                <th>2kHz</th>
                <th>4kHz</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="row-label">Initial AC</td>
                <td>
                  <input
                    type="number"
                    id="acl500Hz"
                    step="5"
                    oninput="updateChart(event)"
                    onblur="syncValues('l', '500Hz')"
                  />
                </td>
                <td>
                  <input
                    type="number"
                    id="acl1kHz"
                    step="5"
                    oninput="updateChart(event)"
                    onblur="syncValues('l', '1kHz')"
                  />
                </td>
                <td>
                  <input
                    type="number"
                    id="acl2kHz"
                    step="5"
                    oninput="updateChart(event)"
                    onblur="syncValues('l', '2kHz')"
                  />
                </td>
                <td>
                  <input
                    type="number"
                    id="acl4kHz"
                    step="5"
                    oninput="updateChart(event)"
                    onblur="syncValues('l', '4kHz')"
                  />
                </td>
              </tr>
              <tr>
                <td class="row-label">Masked AC</td>
                <td>
                  <input
                    type="number"
                    id="macl500Hz"
                    step="5"
                    oninput="updateChart(event)"
                  />
                </td>
                <td>
                  <input
                    type="number"
                    id="macl1kHz"
                    step="5"
                    oninput="updateChart(event)"
                  />
                </td>
                <td>
                  <input
                    type="number"
                    id="macl2kHz"
                    step="5"
                    oninput="updateChart(event)"
                  />
                </td>
                <td>
                  <input
                    type="number"
                    id="macl4kHz"
                    step="5"
                    oninput="updateChart(event)"
                  />
                </td>
              </tr>
              <tr>
                <td class="row-label">Norm Shift</td>
                <td>
                  <input
                    type="number"
                    id="nl500Hz"
                    value="50"
                    step="5"
                    oninput="updateChart(event)"
                  />
                </td>
                <td>
                  <input
                    type="number"
                    id="nl1kHz"
                    value="60"
                    step="5"
                    oninput="updateChart(event)"
                  />
                </td>
                <td>
                  <input
                    type="number"
                    id="nl2kHz"
                    value="60"
                    step="5"
                    oninput="updateChart(event)"
                  />
                </td>
                <td>
                  <input
                    type="number"
                    id="nl4kHz"
                    value="50"
                    step="5"
                    oninput="updateChart(event)"
                  />
                </td>
              </tr>
              <tr class="result-row">
                <td class="row-label">Est. SAL BC</td>
                <td id="resl500Hz">-</td>
                <td id="resl1kHz">-</td>
                <td id="resl2kHz">-</td>
                <td id="resl4kHz">-</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <div class="chart-wrapper card">
        <canvas id="salChart"></canvas>
      </div>
    </div>
    <div id="custom_norms_modal" popover>
      <div id="custom_norms_content" class="norms-container">
        <table>
          <caption>
            Custom Norm Values
          </caption>
          <thead>
            <tr>
              <th></th>
              <th>500Hz</th>
              <th>1kHz</th>
              <th>2kHz</th>
              <th>4kHz</th>
              <th>Action</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="row-label">New Norms</td>
              <td><input type="number" id="newNorm500" step="5" /></td>
              <td><input type="number" id="newNorm1k" step="5" /></td>
              <td><input type="number" id="newNorm2k" step="5" /></td>
              <td><input type="number" id="newNorm4k" step="5" /></td>
              <td><button id="saveNormsButton" class="btn">Save</button></td>
            </tr>
            <tr>
              <td class="row-label">Custom Norms</td>
              <td><span id="custom_norm_five">-</span></td>
              <td><span id="custom_norm_one">-</span></td>
              <td><span id="custom_norm_two">-</span></td>
              <td><span id="custom_norm_four">-</span></td>
              <td><button id="load_custom" class="btn">Load</button></td>
            </tr>
            <tr>
              <td class="row-label">App Defaults</td>
              <td>55</td>
              <td>60</td>
              <td>60</td>
              <td>60</td>
              <td><button id="load_default" class="btn">Load</button></td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <div id="help_text_modal" popover>
      <div id="help_content">
        <h3>When should you use SAL?</h3>
        <p>
          SAL is useful when traditional masking approaches are likely to
          overmask and lead to masking dilemma. Bilateral conductive hearing
          losses with large unmasked air-bone gaps are the most common use case
          for SAL.
        </p>
        <h3>How do I do the test?</h3>

        <p>
          Measure unmasked AC thresholds 500Hz-4kHz in each ear and enter
          results in the 'Initial AC' fields. Place the bone oscillator on
          center of the forehead and present narrow-band masking noise through
          it at the max level of channel 2 (or use the levels listed below the
          grids) then remeasure AC thresholds and enter them in the 'Masked AC'
          fields. The estimated BC thresholds will be calculated and displayed
          in the 'Est. SAL BC' row.
        </p>

        <h3>How does it work?</h3>

        <p>
          SAL uses normative data based on each audiometer and averaged
          responses from normal subjects. Each audiometer likely has different
          maximum outputs for bone-conduction (BC) narrow-band noise (NBN) at
          each freqeuncy. The SAL procedure asks you to set channel 2 to the
          maximum level per frequency/NBN using the BC oscillator placed on the
          patient's forehead. The max output will vary by frequency (usually
          between 40-60dB). You can use the default norms but it is likely
          better to establish specific norms for your booth. The BC masking
          noise will cause the AC thresholds to increase if the ear has
          conductive loss. If the loss is sensory the masking qon't cause much
          shift. The amount of increase (unmasked AC vs masked AC) will guide
          you on the estimated level of the true BC hearing threshold.
        </p>

        <h3>How do I create my own norms?</h3>

        <p>
          Test air-conduction on a few normal subjects at 500Hz, 1kHz, 2kHz, and
          4kHz in each ear (unilateral is also fine). Retest the same subjects
          at the same frequencies via AC but place the BC oscillator on the
          forehead and set channel 2 routed to BC with NBN signal at the highest
          output allowed by the machine. Subtract the unmasked threshold from
          the masked threshold to get the shift value for each frequency.
          Average the shift values across your subjects to get the norm value
          for that frequency.
        </p>

        <h3>How do I save my norms?</h3>
        <p>
          Click the Custom Norms button and enter your data and click save. The
          norms data will only be saved locally to the computer you are
          currently on. This SAL app does not send or sync any data remotely.
        </p>

        <h3>
          What do I do if I reach the limits of the equipment before a masked
          response is obtained?
        </h3>

        <p>
          This can happen when the loss is mixed and the best unmasked BC
          thresolds are near the moderate range of hearing loss. Try another AC
          transducer to see if there is higher output. If that doesn't help then
          you may need to stick with "masking dilemma".
        </p>
        <div class="research">
          <h3>Research &amp; Links</h3>
          <ul>
            <li><a href="#">Jerger Tillman</a></li>
            <li><a href="#">Chaplin Miyamoto</a></li>
          </ul>
          <img
            src="../simple_explanation_table_Chaplin.png"
            alt="simple_description_SAL"
          />
        </div>
      </div>
    </div>
    <script src="main.js"></script>
  </body>
</html>
